<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <title>stevessr的自定义hugo博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/library/highlight.js/monokai.min.css">
<script src="/library/highlight.js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

  
</head>
<body>
    
        <header>
    <link rel="stylesheet" href="/css/styles.css">
    <h1>stevessr的自定义hugo博客</h1>
    <link rel="stylesheet" href="/css/menu.css">
<nav>
    <button class="hamburger-menu">&#9776;</button> 
    <ul class="main-menu">
        <li><a href="/">Home</a></li>
        <li class="dropdown"><a href="/about">About</a><ul class="dropdown-content"><li><a href="/list">list</a></li></ul></li>
        <li><a href="/contact">Contact</a></li>
        <li><a href="/donate">Donate</a></li>
        <li class="dropdown">
            <a href="/tags">Tags</a>
            <ul class="dropdown-content">
                
                <li><a href="/tags/adguard">adguard</a></li>
                
                <li><a href="/tags/chart">chart</a></li>
                
                <li><a href="/tags/go">go</a></li>
                
                <li><a href="/tags/hugo">hugo</a></li>
                
                <li><a href="/tags/nodejs20">nodejs20</a></li>
                
                <li><a href="/tags/replit">replit</a></li>
                
                <li><a href="/tags/uptime-kuma">uptime kuma</a></li>
                
                <li><a href="/tags/windows">windows</a></li>
                
                <li><a href="/tags/%E7%99%BD%E5%AB%96">白嫖</a></li>
                
                <li><a href="/tags/%E8%8B%B1%E8%AF%AD">英语</a></li>
                
                <li><a href="/tags/%E9%A2%9C%E8%89%B2">颜色</a></li>
                
            </ul>
        </li>
        <li class="dropdown">
            <a href="/Categories">Categories</a>
            <ul class="dropdown-content">
                
                <li><a href="/categories/example-category">example-category</a></li>
                
                <li><a href="/categories/go">go</a></li>
                
                <li><a href="/categories/hugo">hugo</a></li>
                
                <li><a href="/categories/nodejs20">nodejs20</a></li>
                
                <li><a href="/categories/uptime-kuma">uptime kuma</a></li>
                
                <li><a href="/categories/%E7%99%BD%E5%AB%96">白嫖</a></li>
                
                <li><a href="/categories/%E8%8B%B1%E8%AF%AD">英语</a></li>
                
                <li><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA">计算机</a></li>
                
                <li><a href="/categories/%E9%A2%9C%E8%89%B2">颜色</a></li>
                
            </ul>
        </li>
    </ul>
</nav>


<script>
document.addEventListener("DOMContentLoaded", function() {
    const hamburgerMenu = document.querySelector('.hamburger-menu');
    const mainMenu = document.querySelector('.main-menu');

    hamburgerMenu.addEventListener('click', function() {
        mainMenu.classList.toggle('active');
    });
});

</script>

</header>
  
    

    <main>
        

<style>
  .container {
    text-align: center;
    width: 90%;
    max-width: 1200px;
    margin: auto;
  }

  .controls {
    margin: 20px 0;
  }

  .year-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
  }

  .month-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 150px;
  }

  .month-label {
    text-align: center;
    font-size: 16px;
    margin-bottom: 5px;
  }

  .heatmap-container {
    display: grid;
    grid-template-columns: repeat(7, 1fr);  
    grid-gap: 2px;
  }

  .heatmap-cell {
    position: relative;
    background-color: transparent;  
    border-radius: 4px;
    box-shadow: 0 0 1px rgba(0, 0, 0, 0.2);
    height: 20px;
    width: 20px;
    transition: background-color 0.3s;
    cursor: pointer;
  }

  .heatmap-cell:hover .tooltip {
    display: block;
  }

  .tooltip {
    display: none;
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background-color: #333;
    color: #fff;
    padding: 5px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    z-index: 10;
    pointer-events: none;
    margin-bottom: 5px;
  }

  .level-1 {
    background-color: #d6e685;
  }  
  .level-2 {
    background-color: #8cc665;
  }  
  .level-3 {
    background-color: #44a340;
  }  
  .level-4 {
    background-color: #1e6823;
  }  
  .level-5 {
    background-color: #196127;
  }  

  .empty-cell {
    visibility: hidden;  
  }

  select {
    padding: 5px;
    font-size: 16px;
  }

   
  @media (max-width: 768px) {
    .month-container {
      width: 100%;
      max-width: none;
      margin-bottom: 20px;
    }

    .heatmap-container {
      grid-gap: 4px;
    }

    .heatmap-cell {
      height: 24px;
      width: 24px;
    }

    .month-label {
      font-size: 14px;
    }
  }

  @media (max-width: 480px) {
    .heatmap-cell {
      height: 18px;
      width: 18px;
    }

    .month-label {
      font-size: 12px;
    }
  }
</style>

<div class="container">
  <h1>博客文章热力图</h1>
  <div class="controls">
    <label for="year-select">选择年份:</label>
    <select id="year-select">
      
    </select>
  </div>
  <div id="year-container" class="year-container"></div>
</div>

<script>
  let xmlCache = null;

  async function fetchXML(url) {
    if (!xmlCache) {
      const response = await fetch(url);
      const text = await response.text();
      const parser = new DOMParser();
      xmlCache = parser.parseFromString(text, "application/xml");
      xmlCache.normalize(); 
    }
    return xmlCache;
  }

  function getDayOfYear(date) {
    const start = new Date(date.getFullYear(), 0, 0);
    const diff = date - start + (start.getTimezoneOffset() - date.getTimezoneOffset()) * 60000;
    return Math.floor(diff / (1000 * 60 * 60 * 24));
  }

  async function generateHeatmap(year) {
    const xml = await fetchXML("/index.xml");
    const items = xml.querySelectorAll("item");

    const postsByDay = Array(366).fill(0); 
    const postsDetails = Array.from({ length: 366 }, () => []);

    items.forEach((item) => {
      const pubDate = item.querySelector("pubDate").textContent;
      const postDate = new Date(pubDate);
      if (postDate.getFullYear() === year) {
        const dayOfYear = getDayOfYear(postDate);
        postsByDay[dayOfYear]++;
        postsDetails[dayOfYear].push(item.querySelector("title").textContent);
      }
    });

    const yearContainer = document.getElementById("year-container");
    yearContainer.innerHTML = "";

    const months = [
      "January", "February", "March", "April", "May", "June", 
      "July", "August", "September", "October", "November", "December"
    ];

    for (let month = 0; month < 12; month++) {
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const firstDayOfMonth = new Date(year, month, 1).getDay();

      const monthContainer = document.createElement("div");
      monthContainer.className = "month-container";

      const monthLabel = document.createElement("div");
      monthLabel.className = "month-label";
      monthLabel.textContent = months[month];
      monthContainer.appendChild(monthLabel);

      const heatmapGrid = document.createElement("div");
      heatmapGrid.className = "heatmap-container";

      
      for (let i = 0; i < firstDayOfMonth; i++) {
        const emptyCell = document.createElement("div");
        emptyCell.className = "heatmap-cell empty-cell";
        heatmapGrid.appendChild(emptyCell);
      }

      for (let day = 1; day <= daysInMonth; day++) {
        const dayOfYear = getDayOfYear(new Date(year, month, day));
        const cell = document.createElement("div");
        cell.className = "heatmap-cell";

        const count = postsByDay[dayOfYear];
        if (count > 0) {
          cell.classList.add(`level-${Math.min(count, 5)}`);
          const tooltip = document.createElement("div");
          tooltip.className = "tooltip";
          tooltip.textContent = `日期: ${year}-${month + 1}-${day}\n文章: ${postsDetails[dayOfYear].join(", ")}`;
          cell.appendChild(tooltip);
        } else {
          cell.style.backgroundColor = "#ddd"; 
          const tooltip = document.createElement("div");
          tooltip.className = "tooltip";
          tooltip.textContent = `日期: ${year}-${month + 1}-${day}`;
          cell.appendChild(tooltip);
        }

        heatmapGrid.appendChild(cell);
      }

      
      const remainingCells = 42 - (firstDayOfMonth + daysInMonth);
      for (let i = 0; i < remainingCells; i++) {
        const emptyCell = document.createElement("div");
        emptyCell.className = "heatmap-cell empty-cell";
        heatmapGrid.appendChild(emptyCell);
      }

      monthContainer.appendChild(heatmapGrid);
      yearContainer.appendChild(monthContainer);
    }
  }

  function populateYearSelect() {
    const yearSelect = document.getElementById("year-select");
    const currentYear = new Date().getFullYear();
    for (let year = 2000; year <= currentYear; year++) {
      const option = document.createElement("option");
      option.value = year;
      option.textContent = year;
      yearSelect.appendChild(option);
    }
    yearSelect.value = currentYear;
  }

  function handleChange() {
    const year = document.getElementById("year-select").value;
    generateHeatmap(parseInt(year));
  }

  function init() {
    populateYearSelect();
    const yearSelect = document.getElementById("year-select");
    yearSelect.addEventListener("change", handleChange);
    handleChange();
  }

  window.onload = init;
</script>

  
    </main>

    
        <footer>
    <p>&copy; 2024 map[]</p>
</footer>
  
    

    
<link rel="stylesheet" href="/js/ajax.js">
  
</body>
</html>
